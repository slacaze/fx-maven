classdef WithFailingTest < fx.maven.test.WithSampleSandbox
    
    methods( TestMethodSetup )
        
        function updateForFailingTests( this )
            copyfile( ...
                fullfile( maventestroot, 'Sample', 'failingpom.xml' ), ...
                fullfile( this.Root, 'pom.xml' ) );
            copyfile(...
                fullfile( maventestroot, 'Sample', 'prjfile.prj' ),...
                fullfile( this.Root, 'code', this.ArtifactId, 'prjfile.prj' ) );
            copyfile(...
                fullfile( maventestroot, 'Sample', 'prjFileExist.m' ),...
                fullfile( this.Root, 'code', this.ArtifactId, 'prjFileExist.m' ) );
            packagePath = cellfun( @(str) sprintf( '+%s', str ), this.ParentPackages,...
                'UniformOutput', false );
            mkdir( fullfile( this.Root, 'test', packagePath{:}, sprintf( '+%s', this.ArtifactId ), '+failingTestOncePackaged' ) );
            copyfile(...
                fullfile( maventestroot, 'Sample', 'tprjFileExist.m' ),...
                fullfile( this.Root, 'test', packagePath{:}, sprintf( '+%s', this.ArtifactId ), '+failingTestOncePackaged', 'tprjFileExist.m' ) );
            mkdir( fullfile( this.Root, 'test', packagePath{:}, sprintf( '+%s', this.ArtifactId ), '+badTests' ) );
            copyfile(...
                fullfile( maventestroot, 'Sample', 'tBadTest.m' ),...
                fullfile( this.Root, 'test', packagePath{:}, sprintf( '+%s', this.ArtifactId ), '+badTests', 'tBadTest.m' ) );
        end
        
    end
    
end